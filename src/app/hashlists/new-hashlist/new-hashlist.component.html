<grid-main>

  <app-page-subtitle subtitle="Create Hashlist"></app-page-subtitle>

  <form [formGroup]="form">

    <grid-autocol>

    <input-text title="Name" formControlName="name"></input-text>

    <input-text title="Notes" formControlName="notes"></input-text>

    <input-select title="Access group" formControlName="accessGroupId" [items]="selectAccessgroup"></input-select>

    <div class="custom-input-container">

      <input-multiselect
        [isLoading]="isLoadingHashtypes"
        [placeholder]="'Hashtypes...'"
        [items]="selectHashtypes"
        [label]="'Hashtype:'"
        formControlName="hashTypeId"
        [multiselectEnabled]="false"
        [mergeIdAndName]="true"
        style="flex: 1;"
      ></input-multiselect>

      <button mat-icon-button matTooltip="Help" (click)="openHelpDialog()">
        <mat-icon>help</mat-icon>
      </button>
    </div>

    <input-select title="Hashlist format" formControlName="format" [items]="selectFormat"></input-select>

    <input-check title="Salted hashes, separator" formControlName="isSalted"></input-check>

    <input-text title="Separator" formControlName="separator"></input-text>

    <input-check title="Salt is in hex (only when salted hashes)" formControlName="isHexSalt"></input-check>

    <div *ngIf="+brainenabled === 1"><hr>

      <h5>Hashcat Brain Enabled</h5>

      <input-select title="Brain mode" formControlName="brainFeatures" [items]="selectFormatbrain"></input-select>

      <mat-card>
        <mat-card-content class="info-message">
            Note: When brain is enabled, it'll create a network server. If used wrongly,
            it could cause bottlenecks or collapse the network server. You can disable
            this setting in Config > Server > General Settings.
        </mat-card-content>
      </mat-card>

    </div>

    <input-select title="Hash Source" formControlName="sourceType" [items]="selectSource"></input-select>

    <div *ngIf="sourceType === 'paste'">
      <input-text-area title="Paste Hash(es)" formControlName="sourceData"></input-text-area>

      <grid-buttons>
        <button-submit name="Cancel" [disabled]="false" type="cancel"></button-submit>
        <button-submit [name]="'Create'" (click)="onSubmit()"></button-submit>
      </grid-buttons>
    </div>

    <div *ngIf="sourceType === 'import'">

      <div class="file-input-container">
        <input type="file" accept="/*" formControlName="sourceData" (change)="handleFileInput($event)" multiple #file class="custom-file-input">
        <mat-icon>attach_file</mat-icon>
        <span class="file-upload-label">Choose File</span>
        <mat-hint class="mt-2">
          <span class="fileuploadspan custom-file-upload-size"></span>
        </mat-hint>
      </div>

      <br>
      <br>

     <div *ngIf="uploadProgress > 0">
        <mat-progress-bar
            mode="determinate"
            [value]="uploadProgress"
            [ngClass]="{
              'mat-primary': uploadProgress < 50,
              'mat-warn': uploadProgress >= 50 && uploadProgress < 100,
              'mat-success': uploadProgress === 100
            }"
          ></mat-progress-bar>

        <!-- <ngb-progressbar
                        type="success"
                        textType="white"
                        [striped]="true"
                        [value]="uploadProgress"
                        [showValue]="true"
        ></ngb-progressbar> -->
      </div>

      <div *ngIf="uploadProgress === 100">
        <p><b>Upload completed!</b></p>
      </div><br>

      <grid-buttons>
        <button-submit name="Cancel" [disabled]="false" type="cancel"></button-submit>
        <button-submit [name]="'Create'" (click)="onuploadFile(file.files);"></button-submit>
      </grid-buttons>
    </div>

    </grid-autocol>
{{form.value | json}}
  </form>
</grid-main>
