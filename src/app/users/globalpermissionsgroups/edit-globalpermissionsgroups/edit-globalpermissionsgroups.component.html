<app-page-title [title]="'Global Permission Group - '+editedGPG.name+''"></app-page-title>
<div class="row g-3">
<!-- Set permissions -->
  <div [ngClass]="editedGPG ? 'col-md-7':'' ">
    <grid-main>
    <app-page-subtitle [subtitle]="'Set Permissions'"></app-page-subtitle>
    <form [formGroup]="updateForm" (ngSubmit)="onSubmit()">
      <input-text title="Name" formControlName="name"></input-text>
      <div fxLayout="row wrap" fxLayoutAlign="start center" fxLayoutGap="10px">
        <button mat-raised-button color="primary" (click)="toggleAllPermissions(true); preventDefault($event)">Check All</button>
        <button mat-raised-button color="warn" (click)="toggleAllPermissions(false); preventDefault($event)">Uncheck All</button>
      </div>
      <div formGroupName="permissions">

        <ng-container *ngFor="let group of permissionGroups">
          <mat-accordion>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <span><b>{{ group.title }}</b></span>
                </mat-panel-title>
              </mat-expansion-panel-header>

              <ng-container *ngFor="let subgroup of group.subgroups">
                <mat-expansion-panel>
                  <mat-expansion-panel-header>
                    <mat-panel-title>
                      <span><b>{{ subgroup.subtitle }}</b></span>
                    </mat-panel-title>
                  </mat-expansion-panel-header>

                  <div *ngFor="let permission of subgroup.permissions" fxLayout="row wrap" fxLayoutAlign="start center" fxLayoutGap="10px">
                    <input-check [title]="getTitleFromPermission(permission)" [formControlName]="permission"></input-check>
                  </div>

                </mat-expansion-panel>
              </ng-container>

            </mat-expansion-panel>
          </mat-accordion>
        </ng-container>

    </div>

      <grid-buttons>
        <button-submit [name]="'Update'"></button-submit>
      </grid-buttons>

    </form>
  </grid-main>
  </div>
  <div class="col-md-5" *ngIf="editedGPG">
    <!-- Table current members -->
    <app-table>
     <div *ngIf="editedGPG">
       <app-page-subtitle [subtitle]="'User Members'"></app-page-subtitle>
       <access-permission-groups-users-table [accesspermgroupId]="editedGPGIndex"></access-permission-groups-users-table>
     </div>
    </app-table>
   </div>
</div>
